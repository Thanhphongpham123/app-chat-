<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Messenger - Chat App</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="messenger-container">
        <!-- Sidebar -->
          <!-- Sidebar -->
        <div class="sidebar">
            <!-- Header -->
            <div class="sidebar-header">
                    <h1>Chats</h1>
                    <div class="user-area" id="userArea">
                        <span id="currentUserDisplay" class="current-user"></span>
                        <button id="logoutBtn" class="icon-btn" style="display:none;" title="ƒêƒÉng xu·∫•t"><i class="fas fa-right-from-bracket"></i></button>
                    </div>
                <div class="header-actions">
                    <button class="icon-btn" title="Cu·ªôc tr√≤ chuy·ªán m·ªõi">
                        <i class="fas fa-pen"></i>
                    </button>
                    <button id="createGroupBtn" class="icon-btn" title="T·∫°o nh√≥m 3 th√†nh vi√™n">
                        <i class="fas fa-users"></i>
                    </button>
                    <button class="icon-btn" title="C√†i ƒë·∫∑t">
                        <i class="fas fa-cog"></i>
                    </button>
                </div>
            </div>

            <!-- Search -->
            <div class="search-box">
                <i class="fas fa-magnifying-glass"></i>
                <input type="text" id="searchInput" placeholder="T√¨m ki·∫øm Messenger">
            </div>

            <!-- Filter Tabs -->
            <div class="chat-filter">
                <div class="filter-left">
                    <button id="filterAll" class="filter-btn active">T·∫•t c·∫£</button>
                    <button id="filterUnread" class="filter-btn">Ch∆∞a ƒë·ªçc</button>
                    <button id="filterCategoryBtn" class="filter-btn">Ph√¢n lo·∫°i ‚ñæ</button>
                </div>

                <!-- d·∫•u 3 ch·∫•m -->
                <div id="filterMenuIcon" class="filter-menu-icon">‚ãØ</div>

                <!-- popup menu -->
                <div id="filterPopupMenu" class="filter-popup">
                    <div id="markAllRead" class="filter-popup-item">ƒê√°nh d·∫•u t·∫•t c·∫£ ƒë√£ ƒë·ªçc</div>
                </div>
            </div>

            <!-- Conversations -->
            <div class="conversations" id="conversationsList">
                <!-- Loaded by JS -->
            </div>

            <div style="padding:8px 12px; font-size:13px; color:#333; display:flex; align-items:center; gap:8px">
                <label style="display:flex; align-items:center; gap:8px; cursor:pointer"><input id="groupNotifToggle" type="checkbox"> Th√¥ng b√°o nh√≥m</label>
            </div>
            <button id="darkModeToggle" class="icon-btn" title="Ch·∫ø ƒë·ªô t·ªëi">
                üåô
            </button>
        </div>

        <!-- Chat Area -->
        <div class="chat-area">
            <!-- Empty State -->
            <div class="empty-chat" id="emptyChat">
                <div class="empty-content">
                    <i class="fas fa-comments"></i>
                    <p>Ch·ªçn m·ªôt cu·ªôc tr√≤ chuy·ªán ho·∫∑c b·∫Øt ƒë·∫ßu cu·ªôc tr√≤ chuy·ªán m·ªõi</p>
                </div>
            </div>

            <!-- Chat Window -->
            <div class="chat-window" id="chatWindow" style="display: none;">
                <!-- Chat Header -->
                <div class="chat-header">
                    <div class="chat-info">
                        <img id="chatAvatar" src="" alt="" class="avatar">
                        <div class="info">
                            <h3 id="chatName"></h3>
                            <span id="chatStatus" class="status">ƒêang ho·∫°t ƒë·ªông</span>
                        </div>
                    </div>
                    <div class="chat-actions">
                        <button class="icon-btn" id="voiceCallBtn" title="G·ªçi tho·∫°i">
                            <i class="fas fa-phone"></i>
                        </button>
                        <button class="icon-btn" id="videoCallBtn" title="G·ªçi video">
                            <i class="fas fa-video"></i>
                        </button>
                        
                        <button id="infoBtn" class="icon-btn" title="Th√¥ng tin cu·ªôc tr√≤ chuy·ªán" onclick="openChangeAvatarModal()">
                            <i class="fas fa-info"></i>
                        </button>
                    </div>
                </div>

                <!-- Messages -->
                <div class="messages" id="messagesContainer">
                    <!-- Loaded by JS -->
                </div>

                <!-- Typing indicator -->
                <div id="typingStatus" class="typing-status"></div>

                <!-- Input Area -->
                <div class="message-input-area">
                    <button class="icon-btn">
                        <i class="fas fa-plus"></i>
                    </button>
                    <button id="imageBtn" class="icon-btn" title="G·ª≠i ·∫£nh">
                        <i class="fas fa-image"></i>
                    </button>
                    <input id="imageFileInput" type="file" accept="image/*" style="display:none">

                    <!-- Emoji -->
                    <button class="icon-btn" id="emojiBtn" title="Emoji">
                        üòä
                    </button>

                    <!-- danh s√°ch emoji-->
                    <div id="emojiPopup" class="emoji-popup" style="display: none;">
                        <span>üòÄ</span><span>üòÇ</span><span>üòç</span><span>ü•∞</span><span>üòò</span>
                        <span>üòé</span><span>üò≠</span><span>üò°</span><span>üëç</span><span>üôè</span>
                        <span>‚ù§Ô∏è</span><span>üî•</span><span>üéâ</span><span>üíØ</span><span>ü§ù</span>
                    </div>

                    <input type="text" id="messageInput" placeholder="Aa" autocomplete="off">
                    <button class="icon-btn" id="sendBtn">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Auth overlay (signup / login) -->
    <div id="authOverlay" class="auth-overlay" style="display:none">
        <div class="auth-card">
            <div class="auth-tabs">
                <button id="tabLogin" class="active">ƒêƒÉng nh·∫≠p</button>
                <button id="tabRegister">ƒêƒÉng k√Ω</button>
            </div>

            <form id="loginForm" class="auth-form">
                <label>T√†i kho·∫£n</label>
                <input id="loginUser" type="text" required>
                <label>M·∫≠t kh·∫©u</label>
                <input id="loginPass" type="password" required>
                <button type="submit">ƒêƒÉng nh·∫≠p</button>
            </form>

            <form id="registerForm" class="auth-form" style="display:none">
                <label>T√†i kho·∫£n</label>
                <input id="regUser" type="text" required>
                <label>M·∫≠t kh·∫©u</label>
                <input id="regPass" type="password" required>
                <label>X√°c nh·∫≠n m·∫≠t kh·∫©u</label>
                <input id="regPass2" type="password" required>
                <button type="submit">T·∫°o t√†i kho·∫£n</button>
            </form>

            <div class="auth-note">T√†i kho·∫£n l∆∞u tr√™n tr√¨nh duy·ªát (localStorage). Kh√¥ng c·∫ßn SQL.</div>
        </div>
    </div>

    <!-- Create Group Modal -->
    <div id="createGroupModal" class="modal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.4); align-items:center; justify-content:center;">
        <div class="modal-card" style="background:#fff; padding:16px; width:320px; border-radius:8px; box-shadow:0 6px 18px rgba(0,0,0,0.2);">
            <h3 style="margin-top:0">T·∫°o nh√≥m 3 th√†nh vi√™n</h3>
            <div style="font-size:13px; color:#444; margin-bottom:8px">Ch·ªçn th√†nh vi√™n kh√°c (ho·∫∑c d√πng "Ch·ªçn t·∫•t c·∫£")</div>
            <div id="groupUsersList" style="max-height:180px; overflow:auto; border:1px solid #eee; padding:8px; border-radius:4px; margin-bottom:8px">
                <!-- populated by JS -->
            </div>
            <label style="display:flex; align-items:center; gap:8px; font-size:13px; margin-bottom:8px"><input type="checkbox" id="selectAllGroupUsers"> Ch·ªçn t·∫•t c·∫£ th√†nh vi√™n</label>
            <label style="font-size:13px">T√™n nh√≥m (t√πy ch·ªçn)</label>
            <input id="groupNameInput" type="text" placeholder="T√™n nh√≥m" style="width:100%; padding:8px; margin:6px 0 12px; box-sizing:border-box">
            <div style="text-align:right">
                <button id="cancelCreateGroup" class="icon-btn" style="margin-right:8px">Hu·ª∑</button>
                <button id="confirmCreateGroup" class="icon-btn">T·∫°o nh√≥m</button>
            </div>
        </div>
    </div>

    <!-- Info Panel (right side) -->
    <div id="infoPanel" class="info-panel" style="display:none;">
        <div class="info-panel-card">
            <div class="panel-header">
                <h3>Th√¥ng tin cu·ªôc tr√≤ chuy·ªán</h3>
                <button id="closeInfoPanel" class="icon-btn">√ó</button>
            </div>

            <div class="panel-tabs">
                <button id="tabAvatar" class="panel-tab active" title="·∫¢nh nh√≥m">
                    <i class="fas fa-image" style="margin-right:6px"></i>
                    <span>·∫¢nh nh√≥m</span>
                </button>
                <button id="tabMembers" class="panel-tab" title="Th√†nh vi√™n">
                    <i class="fas fa-users" style="margin-right:6px"></i>
                    <span>Th√†nh vi√™n</span>
                    <span id="membersCountBadge" class="badge"></span>
                </button>
            </div>

            <div id="sectionAvatar" class="panel-section">
                <label class="panel-label">·∫¢nh nh√≥m</label>
                <div style="display:flex; gap:12px; align-items:center; margin-bottom:8px">
                    <img id="changeAvatarPreview" src="" alt="preview" style="width:64px; height:64px; border-radius:8px; object-fit:cover; border:1px solid #eee">
                    <div style="flex:1">
                        <div style="display:flex; gap:8px; align-items:center; margin-bottom:8px">
                            <button id="addImageBtn" class="icon-btn" title="Th√™m ·∫£nh">Th√™m ·∫£nh</button>
                            <input id="changeAvatarFile" type="file" accept="image/*" style="display:none">
                        </div>
                        <input id="changeAvatarInput" type="text" placeholder="https://.../avatar.jpg" style="margin-bottom:8px; width:100%">
                    </div>
                    <div style="display:flex; flex-direction:column; gap:8px; align-items:center;">
                        <button id="updateAvatarBtn" class="icon-btn confirm" style="padding:6px 10px;">C·∫≠p nh·∫≠t</button>
                    </div>
                </div>

                <div style="font-size:13px; color:#444; margin-bottom:8px">Ho·∫∑c ch·ªçn avatar m·∫∑c ƒë·ªãnh</div>
                <div id="defaultAvatars" class="default-avatar-grid" style="margin-bottom:8px">
                    <!-- populated by JS -->
                </div>

                <div style="text-align:right; margin-top:8px">
                    <button id="confirmChangeAvatar" class="icon-btn confirm">C·∫≠p nh·∫≠t</button>
                </div>
            </div>

            <div id="sectionMembers" class="panel-section" style="display:none">
                <label class="panel-label">T√™n nh√≥m</label>
                <div style="margin:8px 0">
                    <div style="display:flex; gap:8px; margin-top:6px;">
                        <input id="renameGroupInput" type="text" placeholder="T√™n nh√≥m" style="flex:1; padding:8px 10px; border:1px solid #e8e8e0; border-radius:8px">
                        <button id="renameGroupBtn" class="icon-btn confirm" style="padding:6px 10px; border-radius:8px">ƒê·ªïi t√™n</button>
                    </div>
                </div>

                <label class="panel-label">Th√†nh vi√™n</label>
                <div id="panelMembersList" style="font-size:13px; color:#444"> <!-- populated by JS --> </div>
                <div class="members-controls" style="display:flex; gap:8px; margin-top:8px">
                    <input id="addMemberInput" type="text" placeholder="Nh·∫≠p t√™n th√†nh vi√™n" style="flex:1; padding:8px 10px; border:1px solid #e8e8e8; border-radius:8px">
                    <button id="addMemberBtn" type="button" class="icon-btn confirm" title="Th√™m th√†nh vi√™n" style="padding:6px 12px; border-radius:8px">Th√™m</button>
                </div>
                <div style="font-size:12px; color:#777; margin-top:6px">Ch·ªâ √°p d·ª•ng cho nh√≥m. B·∫°n kh√¥ng th·ªÉ xo√° ch√≠nh m√¨nh v√† nh√≥m ph·∫£i c√≤n √≠t nh·∫•t 2 th√†nh vi√™n.</div>
                <div style="text-align:right; margin-top:8px">
                    <button id="deleteGroupBtn" class="icon-btn" style="background:#e74c3c; color:#fff; border-radius:8px; padding:6px 12px">X√≥a nh√≥m</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Call Modal -->
    <div id="callModal" class="call-modal" style="display:none;">
        <div class="call-overlay"></div>
        <div class="call-card">
            <div class="call-type" id="callType">Cu·ªôc g·ªçi tho·∫°i</div>
            <img id="callAvatar" src="" alt="" class="call-avatar">
            <h3 id="callName" class="call-name"></h3>
            <div id="callStatus" class="call-status">ƒêang g·ªçi...</div>
            <div id="callTimer" class="call-timer" style="display:none;">00:00</div>
            
            <div class="call-actions">
                <button id="answerCallBtn" class="call-btn answer" style="display:none;" title="Tr·∫£ l·ªùi">
                    <i class="fas fa-phone"></i>
                </button>
                <button id="endCallBtn" class="call-btn end" title="K·∫øt th√∫c">
                    <i class="fas fa-phone-slash"></i>
                </button>
            </div>
        </div>
    </div>

    <div id="categoryFilterPopup" class="filter-popup filter-category-popup" style="display:none;">
        <div class="filter-popup-title">Theo th·∫ª ph√¢n lo·∫°i</div>

        <div class="filter-category-list">
            <!-- render b·∫±ng JS -->
        </div>
    </div>


    <script src="script.js"></script>
    <script>
        // Example usage: open auth overlay or check current user via console.
    </script>
</body>
</html>
